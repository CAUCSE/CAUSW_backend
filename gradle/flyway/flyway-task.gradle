// flyway-task.gradle

tasks.register('flywayCreate') {
    doLast {
        def description = project.findProperty('desc') ?: null
        if (!description) throw new GradleException("Cannot run 'flywayCreate': Missing required property -Pdesc=...")

        def timestamp = new Date().format("yyyyMMddHHmmss")
        def file = file("src/main/resources/db/migration/V${timestamp}__${description}.sql")
        file.text = "-- Migration: ${description}\n"

        println "âœ… Created: ${file.path}"
    }
}
