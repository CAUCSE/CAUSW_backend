static def loadEnvToProjectExt(Project project, String env = "local") {
    def envFile = project.rootProject.file(".env.${env}")
    if (!envFile.exists()) {
        project.logger.lifecycle("⚠️ .env.${env} not found")
        return
    }

    project.logger.lifecycle("🔧 Loading to project.ext from .env.${env}")
    envFile.eachLine { line ->
        def trimmedLine = line.trim()
        if (!trimmedLine || trimmedLine.startsWith('#')) return

        def (key, value) = line.split('=', 2)
        if (key && value) {
            project.ext.set(key.trim(), value.trim())
        }
    }
}

return this.&loadEnvToProjectExt
