name: Setup Common Environment
description: Checkout, JDK, Gradle Cache, Secrets, gradlew 권한 부여

runs:
  using: "composite"
  steps:
    # 작업 엑세스 가능하게 $GITHUB_WORKSPACE에서 저장소를 체크아웃
    - name: Checkout branch
      uses: actions/checkout@v4

    # java 버전 세팅(JDK 17)
    - name: Set up JDK 17
      uses: actions/setup-java@v4
      with:
        java-version: '17'
        distribution: 'zulu'

    # Gradle 패키지 캐싱
    - name: Cache Gradle packages
      uses: actions/cache@v4
      with:
        path: |
          ~/.gradle/caches
          ~/.gradle/wrapper
        key: ${{ runner.os }}-gradle-${{ hashFiles('**/*.gradle*', '**/gradle-wrapper.properties') }}
        restore-keys: |
          ${{ runner.os }}-gradle-

    # gradlew 실행 권한 부여
    - name: Make gradlew executable
      run: chmod +x ./gradlew
      shell: bash
