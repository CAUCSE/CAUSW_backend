name: "Discord Notify"
description: "Send deploy result to Discord"
inputs:
  repository:
    description: "The GitHub repository"
    required: true
  status:
    description: "The status of the job, e.g., success or failure"
    required: true
  branch:
    description: "The branch name for the deployment"
    required: true
  sha:
    description: "The commit SHA"
    required: true
  actor:
    description: "The GitHub actor who triggered the workflow"
    required: true
  run_id:
    description: "The GitHub Actions run ID"
    required: true
  webhook:
    description: "Discord webhook URL"
    required: true
  role_id:
    description: "Discord role ID to mention on failure"
    required: true

runs:
  using: "composite"
  steps:
    - name: Discord Notify (Always)
      uses: sarisia/actions-status-discord@v1
      with:
        webhook: ${{ inputs.webhook }}

        status: ${{ inputs.status }}

        content: >-
          ${{ inputs.status == 'success' &&
              format('`[{0}]` ğŸ‰ ë°°í¬ê°€ ì„±ê³µì ìœ¼ë¡œ ì™„ë£Œëì–´ìš”!', inputs.branch)
          || format('`[{0}]` ğŸš¨ ë°°í¬ ì‹¤íŒ¨! <@&{1}> í™•ì¸í•´ì£¼ì„¸ìš”.', inputs.branch, inputs.role_id) }}

        title: >-
          ${{ inputs.status == 'success' &&
              format('âœ… [{0}] ë°°í¬ ì„±ê³µ', inputs.branch)
          || format('âŒ [{0}] ë°°í¬ ì‹¤íŒ¨', inputs.branch) }}

        description: |
          ğŸ›  ë¸Œëœì¹˜: `${{ inputs.branch }}`
          ğŸ”– ì»¤ë°‹: `${{ inputs.sha }}`
          ğŸ™‹ ì‘ì„±ì: `${{ inputs.actor }}`
          ğŸ”— [ê¹ƒí—ˆë¸Œ ì•¡ì…˜ ë¡œê·¸ ë³´ê¸°](https://github.com/${{ inputs.repository }}/actions/runs/${{ inputs.run_id }})

        color: ${{ inputs.status == 'success' && '0x00ff00' || '0xff0000' }}

        username: "ğŸš€ ë°°í¬ ë´‡"